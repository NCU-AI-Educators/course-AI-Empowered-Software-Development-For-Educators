<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>AI æ™ºèƒ½é¤å…</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 2rem; background-color: #f5f5f5; }
        .container { max-width: 600px; margin: 0 auto; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        h1 { text-align: center; color: #333; }
        .menu-item { display: flex; justify-content: space-between; border-bottom: 1px solid #eee; padding: 10px 0; }
        button { background-color: #ff6b6b; color: white; border: none; padding: 5px 15px; border-radius: 20px; cursor: pointer; }
        button:hover { background-color: #ff5252; }
        #status-area { margin-top: 20px; padding: 10px; background: #e3f2fd; border-radius: 8px; display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ½ï¸ AI æ™ºèƒ½é¤å…</h1>
        <div id="menu-list">
            <p>æ­£åœ¨æ‹‰å–èœå•...</p>
        </div>
        <div id="status-area"></div>
    </div>

    <script>
        const API_BASE = 'http://127.0.0.1:8000';

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è·å–èœå•
        window.onload = async () => {
            try {
                const res = await fetch(`${API_BASE}/menu`);
                const data = await res.json();
                renderMenu(data.data);
            } catch (err) {
                document.getElementById('menu-list').innerHTML = `<p style='color:red'>æ— æ³•è¿æ¥åå¨ (API)ã€‚è¯·æ£€æŸ¥ Python æ˜¯å¦è¿è¡Œã€‚</p>`;
            }
        };

        function renderMenu(menu) {
            const container = document.getElementById('menu-list');
            container.innerHTML = '';
            for (const [name, info] of Object.entries(menu)) {
                const div = document.createElement('div');
                div.className = 'menu-item';
                div.innerHTML = `
                    <span><b>${name}</b> (Â¥${info.price}) - ${info.time}åˆ†é’Ÿ</span>
                    <button onclick="order('${name}')">ç‚¹é¤</button>
                `;
                container.appendChild(div);
            }
        }

        async function order(dishName) {
            const statusDiv = document.getElementById('status-area');
            statusDiv.style.display = 'block';
            statusDiv.innerText = `æ­£åœ¨ä¸‹å•: ${dishName}...`;
            
            try {
                const res = await fetch(`${API_BASE}/order`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({dish_name: dishName, count: 1})
                });
                const result = await res.json();
                statusDiv.innerText = `âœ… ${result.message}! æ€»ä»·: Â¥${result.total_price}, é¢„è®¡ç­‰å¾…: ${result.wait_minutes}åˆ†é’Ÿ`;
            } catch (err) {
                statusDiv.innerText = `âŒ ä¸‹å•å¤±è´¥: ${err}`;
            }
        }
    </script>
</body>
</html>
